{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 7,
  "summary": "Backend service for dart scoring.",
  "architectural_notes": [
    "Add CORS headers to JSON responses and support OPTIONS for any path by returning 204 with CORS headers.",
    "Temporarily disable/avoid serving the HTML landing page from the Motoko http_request handler; unmatched routes should return JSON 404 {\"error\":\"not_found\"} (still include CORS headers).",
    "CORS headers must be included on every HTTP response from the Motoko http_request handler (JSON responses and OPTIONS 204)."
  ],
  "known_issues": [
    "Backend currently returns the HTML landing page for every path; HTTP routing is not active. Must return JSON for /health and /auth/google/* and not serve HTML."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-create-a-minimal-frontend-shell-with-a-coherent-visual-theme-colors-typography-spacing-and-component-styling-applied-consistently-across-the-app-without-adding-additional-product-features-beyond-a-basic-landing-scaffold",
      "title": "Create a minimal frontend shell with a coherent visual theme (colors, typography, spacing, and component styling) applied consistently across the app, without adding additional product features beyond a basic landing scaffold.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Create a dart scoring backend service (API + data model)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Implement a Motoko backend canister that persists dart scoring data models and exposes a Candid API to manage games, players, and scoring events.",
      "reqIds": [
        "REQ-1"
      ],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Provide API methods to create and query games and players, including the ability to start a new game with rules and retrieve game state by id.",
      "reqIds": [
        "REQ-2"
      ],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Implement dart scoring logic and an API to record throws/turns and compute scores according to standard rules, including bust handling and optional double-out finishing.",
      "reqIds": [
        "REQ-3"
      ],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Add backend-side validation, error handling, and deterministic IDs for stable operation (no traps on invalid input).",
      "reqIds": [
        "REQ-4"
      ],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Fix Motoko canister HTTP routing: handle req.method+req.url, add JSON endpoints (/health, /auth/google/start, /auth/google/callback), CORS headers, and OPTIONS preflight (204) while keeping HTML landing page fallback.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Implement or fix the canister HTTP request handler (`http_request` as a `query`) in `backend/main.mo` so it routes based on `req.method` and the URL path parsed from `req.url` (ignore any query string).",
      "reqIds": [
        "REQ-6"
      ],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Add HTTP routing for the following endpoints in the Motoko HTTP handler:\n- `GET /health` returns `200` JSON body `{\"ok\": true}`\n- `GET /auth/google/start` returns `200` JSON body `{\"ok\": true, \"message\": \"google start reached\"}`\n- `GET /auth/google/callback` returns `200` JSON body `{\"ok\": true, \"message\": \"google callback reached\"}`",
      "reqIds": [
        "REQ-7"
      ],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Add CORS headers to all JSON responses returned by the Motoko HTTP handler:\n- `Access-Control-Allow-Origin: *`\n- `Access-Control-Allow-Methods: GET,POST,PUT,OPTIONS`\n- `Access-Control-Allow-Headers: Content-Type, Authorization, X-ADMIN-TOKEN`",
      "reqIds": [
        "REQ-9"
      ],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Handle `OPTIONS` requests for any path in the Motoko HTTP handler by returning status `204` with the specified CORS headers and an empty body.",
      "reqIds": [
        "REQ-10"
      ],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Disable HTML landing page fallback in Motoko http_request handler; for non-matching routes return JSON 404 {\"error\":\"not_found\"} with CORS headers on every response (including 204 OPTIONS).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Implement the Internet Computer HTTP interface in `backend/main.mo` by adding a public query function `public query func http_request(req : HttpRequest) : async HttpResponse` that performs routing based on `req.method` and the URL path parsed from `req.url` (ignore any query string).",
      "reqIds": [
        "REQ-11"
      ],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "In `http_request`, implement method+path routing exactly as follows: (a) if `req.method == \"OPTIONS\"`, return HTTP 204 with an empty body; (b) if `req.method == \"GET\"` and path is `/health`, return HTTP 200 with JSON body `{\"ok\":true}`; (c) if `GET` and path is `/auth/google/start`, return HTTP 200 with JSON body `{\"ok\":true,\"message\":\"google start reached\"}`; (d) if `GET` and path is `/auth/google/callback`, return HTTP 200 with JSON body `{\"ok\":true,\"message\":\"google callback reached\"}`; (e) otherwise return HTTP 404 with JSON body `{\"error\":\"not_found\"}`.",
      "reqIds": [
        "REQ-12"
      ],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Add the following CORS headers to every `http_request` response (including 204 and 404): `Access-Control-Allow-Origin: *`, `Access-Control-Allow-Methods: GET,POST,PUT,OPTIONS`, `Access-Control-Allow-Headers: Content-Type, Authorization, X-ADMIN-TOKEN`.",
      "reqIds": [
        "REQ-13"
      ],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Disable/remove the HTML landing page response from the canister HTTP handler so that no path returns an HTML page; non-matching routes must return the JSON 404 response instead.",
      "reqIds": [
        "REQ-14"
      ],
      "status": "pending"
    }
  ],
  "projectName": "Dart Scoring Backend",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}